{
    "device_alias": { 
        "Play": "Play", 
        "Virus": "Uno MIDI",
        "Uc33": "UC-33" 
    },
    "scales": {
        "virus_minor": [0, 1, 4, 6, 8, 10, 11],
        "simple_triad": [0, 4, 7] 
    },
    "version_map": [
        { 
            "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 121, 
            "version_out": 0 
        },
        { 
            "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 122, 
            "version_out": 9 
        },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 1, "version_out": 1 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 2, "version_out": 2 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 3, "version_out": 3 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 4, "version_out": 4 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 5, "version_out": 5 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 6, "version_out": 6 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 7, "version_out": 7 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 8, "version_out": 8 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 124, "version_out": 11 },
        { "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 125, "version_out": 12 }
    ],
    "input_filter": [
        {
            "_comment": "INICIALIZACION",
            "version": 0,
            "output": [
                {"var_0": 1},{"var_1": 0},{"var_2": 1},{"var_3": 0},{"var_4": 1},{"var_5": 0},{"var_6": 1},{"var_7": 0},
                {"var_11": 0},{"var_12": 0}, {"var_14": 48}, {"var_15": "var_14"}, {"var_10": "virus_minor"}
            ] 
        },
        {
            "_comment": "PRESET: Todas las capas impares activas",
            "version": 9,
            "output": [
                {"var_0": 1},{"var_1": 0},{"var_2": 1},{"var_3": 0},{"var_4": 1},{"var_5": 0},{"var_6": 1},{"var_7": 0},
                {"var_11": 0},{"var_12": 0}
            ] 
        },
        { "_comment": "Toggle Capa 1 (Bajo 1)", "version": 1, "output": [{"var_0": "1 if var_0 == 0 else 0"}] },
        { "_comment": "Toggle Capa 2 (Bajo 2/Sub)", "version": 2, "output": [{"var_1": "1 if var_1 == 0 else 0"}] },
        { "_comment": "Toggle Capa 3 (Pad 1)", "version": 3, "output": [{"var_2": "1 if var_2 == 0 else 0"}] },
        { "_comment": "Toggle Capa 4 (Pad 2)", "version": 4, "output": [{"var_3": "1 if var_3 == 0 else 0"}] },
        { "_comment": "Toggle Capa 5 (Lead 1)", "version": 5, "output": [{"var_4": "1 if var_4 == 0 else 0"}] },
        { "_comment": "Toggle Capa 6 (Lead 2)", "version": 6, "output": [{"var_5": "1 if var_5 == 0 else 0"}] },
        { "_comment": "Toggle Capa 7 (Arp 1)", "version": 7, "output": [{"var_6": "1 if var_6 == 0 else 0"}] },
        { "_comment": "Toggle Capa 8 (Arp 2)", "version": 8, "output": [{"var_7": "1 if var_7 == 0 else 0"}] },
        { "_comment": "Toggle Rango Aleatorio Notas", "version": 11, "output": [{"var_11": "6 if var_11 == 0 else 0"}] },
        { "_comment": "Toggle Rango Aleatorio Velocidad", "version": 12, "output": [{"var_12": "8 if var_12 == 0 else 0"}] },

        {
            "_comment": "CC#7 en Ch1 de Uc33 controla toggle de var_0 (Capa 1) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 0,
            "output": [ {"var_0": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "CC#7 en Ch2 de Uc33 controla toggle de var_1 (Capa 2) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 1,
            "output": [ {"var_1": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "CC#7 en Ch3 de Uc33 controla toggle de var_2 (Capa 3) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 2,
            "output": [ {"var_2": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "CC#7 en Ch4 de Uc33 controla toggle de var_3 (Capa 4) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 3,
            "output": [ {"var_3": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "CC#7 en Ch5 de Uc33 controla toggle de var_4 (Capa 5) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 4,
            "output": [ {"var_4": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "CC#7 en Ch6 de Uc33 controla toggle de var_5 (Capa 6) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 5,
            "output": [ {"var_5": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "CC#7 en Ch7 de Uc33 controla toggle de var_6 (Capa 7) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 6,
            "output": [ {"var_6": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "CC#7 en Ch8 de Uc33 controla toggle de var_7 (Capa 8) y reenvía CC",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": 7, "ch_in": 7, 
            "output": [ {"var_7": "0 if value_2_in == 0 else 1" }, {"device_out": "Virus"}] 
        },
        {
            "_comment": "Uc33 CCs de Control General (12,13,14) passthrough",
            "device_in": "Uc33", "event_in": "cc", "value_1_in": [12, 13, 14],
            "device_out": "Virus"
        },
        {
            "_comment": "Program Change desde Uc33 establece la tónica (var_15) relativa a var_14",
            "device_in": "Uc33", "event_in": "program_change",
            "output": [{"var_15": "var_14 + value_1_in"}] 
        },
        {
            "_comment": "CC#123 valor 13 desde Uc33 Ch9 cicla la tónica (var_15)",
            "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 13,
            "output": [{"var_15": "var_15 + 1 if var_15 < 71 else 60"}] 
        },
        {
            "_comment": "CC#123 valor 12 desde Uc33 Ch9 cicla el tipo de escala (var_10)",
            "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 123, "value_2_in": 12,
            "output": [{"var_10": "'minor_natural' if var_10 == 'virus_minor' else ('pentatonic_major' if var_10 == 'minor_natural' else ('chromatic' if var_10 == 'pentatonic_major' else 'virus_minor'))"}]
        },
        {
            "_comment": "CC#9 en Uc33 Ch9 selecciona la tónica (var_15) directamente",
            "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 9,
            "output": [{"var_15": "value_2_in"}] 
        },
        {
            "_comment": "CC#10 en Uc33 Ch9 controla rangos de aleatorización para notas (var_11) y velocidad (var_12)",
            "device_in": "Uc33", "event_in": "cc", "ch_in": 8, "value_1_in": 10,
            "output": [{"var_11": "value_2_in / 10"}, {"var_12": "value_2_in / 20"}] 
        },
        {
            "_comment": "Capas de Bajo (entrada por Play Ch1)",
            "device_in": "Play", "ch_in": 0, "event_in": "note",
            "output": [
                { "device_out": "Virus", "channel_out": "0 if var_0 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "value_1_in", "scale_root": "var_15", "scale_type": "var_10"}}  },
                { "device_out": "Virus", "channel_out": "1 if var_1 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "value_1_in", "scale_root": "var_15", "scale_type": "var_10"}}  }
            ]
        },
        {
            "_comment": "Capas de Pads (entrada por Play Ch3)",
            "device_in": "Play", "ch_in": 2, "event_in": "note",
            "output": [
                { "device_out": "Virus", "channel_out": "2 if var_2 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "value_1_in", "scale_root": "var_15", "scale_type": "var_10"}} },
                { "device_out": "Virus", "channel_out": "3 if var_3 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "value_1_in", "scale_root": "var_15", "scale_type": "var_10"}}  }
            ]
        },
        {
            "_comment": "Capas de Leads (entrada por Play Ch5)",
            "device_in": "Play", "ch_in": 4, "event_in": "note",
            "output": [
                { "device_out": "Virus", "channel_out": "4 if var_4 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "value_1_in", "scale_root": "var_15", "scale_type": "var_10"}},  
                  "value_2_out": "random(value_2_in - var_12, value_2_in + var_12)"},
                { "device_out": "Virus", "channel_out": "5 if var_5 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "value_1_in", "scale_root": "var_15", "scale_type": "var_10"}},  
                  "value_2_out": "random(value_2_in - var_12, value_2_in + var_12)"}
            ]
        },
        {
            "_comment": "Capas de Arps (entrada por Play Ch7)",
            "device_in": "Play", "ch_in": 6, "event_in": "note",
            "output": [
                { "device_out": "Virus", "channel_out": "6 if var_6 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "random(value_1_in - var_11, value_1_in + var_11)", "scale_root": "var_15", "scale_type": "var_10"}},  
                  "value_2_out": "random(value_2_in - var_12, value_2_in + var_12)" },
                { "device_out": "Virus", "channel_out": "7 if var_7 == 1 else 15",
                  "value_1_out": { "scale_notes": {"scale_value": "random(value_1_in - var_11, value_1_in + var_11)", "scale_root": "var_15", "scale_type": "var_10"}},  
                  "value_2_out": "random(value_2_in - var_12, value_2_in + var_12)" }
            ]
        }
    ]
}